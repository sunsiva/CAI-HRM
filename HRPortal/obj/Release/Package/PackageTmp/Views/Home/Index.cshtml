@model HRPortal.Models.JobAndCandidateViewModels
@using HRPortal.Helper;

@{
    ViewBag.Title = "Home Page";
    var isSuperAdmin = HelperFuntions.HasValue(HttpRuntime.Cache.Get(CacheKey.RoleName.ToString())).ToUpper().Contains("ADMIN") ? "True" : "False";
}

<div class="row">
    <div class="col-md-4">
        @if (isSuperAdmin == "True")
        {
            <br />
            @Html.Partial("_SearchCriteria")
            @Html.Partial("_CandidateList", Model.CandidateItems)
        }
            else {@Html.Partial("_JobList", Model.JobItems) }
    </div>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script lang="ja" type="text/javascript">
    $(document).ready(function () {
        $(function () {
            // This will make every element with the class "date-picker" into a DatePicker element
            $('.date-picker').datepicker();
        });

        window.myPanel = function (data) {
            $(".candidate-name").text(data.dataset.customName);
            $("#hdnCandidateId").val(data.dataset.customValue);
            var currentSts = $("#btnStsPnl_" + data.dataset.customValue + "").text();
            $("#ddlStatusList option:contains(" + currentSts + ")").attr("selected", true);
            $("#txtStsComments").val("");
        };

        $("#btnStatus").click(function () {
            if ($("#ddlStatusList").val() == "") { $("#errMsgModal").text("Please select a status to change."); return false; }
            else if ($("#txtStsComments").val() == "") { $("#errMsgModal").text("Please write a comments to change."); return false; }
            else {
                $.get("/Home/StatusUpdate", { id: $("#hdnCandidateId").val(), status: $("#ddlStatusList").val(), comments: $("#txtStsComments").val() }, function (data) {
                    $("#btnStsPnl_" + $("#hdnCandidateId").val() + "").text($("#ddlStatusList option:selected").text());
                });
            }
        });

         $('#CollapseMe').click(function () {
             $(this).hasClass('glyphicon-triangle-bottom') ? $(this).removeClass('glyphicon-triangle-bottom') && $(this).addClass('glyphicon-triangle-top') : $(this).removeClass('glyphicon-triangle-top') && $(this).addClass('glyphicon-triangle-bottom');
         });
       
         $("#btnSearchCriteria").click(function () {
             $.get("/Home/SearchCriteria", { name: $("#txtCriteriaCanName").val(), vendor: $("#txtCriteriaVendor").val(), status: $("#txtCriteriaStatus").val(), stdt: $("#txtCriteriaStDate").val(), edt: $("#txtCriteriaEndDate").val() }, function (data) {
                 $("#CandidatesPartial").html(data);
             });
         });
    });
</script>
}